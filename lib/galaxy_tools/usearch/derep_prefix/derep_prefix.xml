<tool id="derep_prefix" name="Dereplication using prefix matching">

	<description>with derep_prefix of usearch</description>

    <macros>
    </macros>

	<requirements>
    </requirements>

    <stdio>
        <regex match="error"
               source="stderr"
               level="fatal"
               description="" />
        <regex match="warning"
               source="stderr"
               level="warning"
               description="" />
        <regex match="denied"
               source="stderr"
               level="fatal"
               description="" />
        <regex match="Invalid"
               source="stderr"
               level="fatal"
               description="" />
    </stdio>

    <version_command></version_command>

  	<!--<command>-->
    <command interpreter="python">
        derep_prefix_wrapper.py 
            --src_dir $os.getcwd()
            --input_sequence_file $sequence_file
            --output_file $unique_sequence_file
            --size_annotation $size_annotation

            #if $minimum_size.test :
                --min_unique_size $minimum_size.value
            #end if

            #if $minimum_seq_length.test :
                --min_seq_length $minimum_seq_length.value
            #end if

            #if $relabel.test :
                --relabel $relabel.value
            #end if

            #if $eliminate_cluster.test :
                --conserve_cluster_nb $eliminate_cluster.value
            #end if

            --os $os_info
    </command>

  	<inputs>
        <param name="sequence_file" type="data" format="fasta,fastq" label="Input sequence file" help=""/>
        <param name="os_info" type="select" display="radio" label="Computer OS" help="">
            <option value="mac">Mac OSX</option>
            <option value="linux" selected="true">Linux</option>
            <option value="window">Windows</option>
        </param>

        <param name='size_annotation' type='boolean' checked="true" truevalue='yes' falsevalue='no' label='Addition of size annotations to the unique sequence labels?' help=""/>

        <conditional name="minimum_size">
            <param name='test' type='boolean' checked="false" truevalue='yes' falsevalue='no' label="Set a minimum size for cluster?" help="Unique sequences with smaller clusters are not included in the output file"/>
            <when value="yes">
                <param name="value" type="integer" min="0" max="1000" value="2" label="Minimum size for cluster" help=""/>
            </when>
        </conditional>

        <conditional name="minimum_seq_length">
            <param name='test' type='boolean' checked="false" truevalue='yes' falsevalue='no' label="Set a minimum sequence length?" help="Using this option may significantly improve execution speed if there are very short sequences in the input which are not needed in the output"/>
            <when value="yes">
                <param name="value" type="integer" min="0" max="1000" value="2" label="Minimum sequence length" help=""/>
            </when>
        </conditional>

        <conditional name="relabel">
            <param name='test' type='boolean' checked="false" truevalue='yes' falsevalue='no' label="Relabel?" help="A string is used to re-label the dereplicated sequences. An integer is appended to the label"/>
            <when value="yes">
                <param name="value" type="text" size="30" value="" label="New prefix" help=""/>
            </when>
        </conditional>

        <conditional name="eliminate_cluster">
            <param name='test' type='boolean' checked="false" truevalue='yes' falsevalue='no' label="Conserve only the largest clusters?" help=""/>
            <when value="yes">
                <param name="value" type="integer" min="0" max="1000" value="2" label="Number of largest cluster to conserve" help=""/>
            </when>
        </conditional>
  	</inputs>

  	<outputs>
        <data format="fasta" name="unique_sequence_file" label="uniques_${sequence_file.name}" />
  	</outputs>

  	<tests>
  
  	</tests>

  	<help>

        **What it does**

        Dereplication is the identification of unique sequences so that only one copy of each sequence is reported. 

        Here, derep_prefix command of usearch tool is used.

        -----

        **Input**

        The input is one sequence file.

        -----

        **Outputs**

        -----
        
        **Parameters**


  	</help>

    <citations>
    </citations>
</tool>

