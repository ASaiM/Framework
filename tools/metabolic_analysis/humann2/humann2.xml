<tool id="humann2" name="Functional profiling">

    <description>with HUMAnN2</description>

    <macros>

    </macros>

    <requirements>
    </requirements>

    <stdio>
    </stdio>

    <version_command></version_command>

    <!--<command>-->
    <command>
        humann2 -i $input_file 
            -o $html_file 

            #if $taxonomic_profile.test:
                --taxonomic-profile $taxonomic_profile.file
            #end if

            --metaphlan ../../non_rRNA_taxonomic_assignation/metaphlan

            --evalue $e_value
            --identity-threshold $identity
            --protein-database /data/db/uniref
            --nucleotide-database /data/db/chocophlan
    </command>

    <inputs>
        <param name="input_file" type="data" format="fastq,fasta,sam,bam,biom" label="Input file" help=""/>

        <conditional name="taxonomic_profile">
            <param name='test' type='boolean' checked="false" truevalue='yes' falsevalue='no' label="Use a custom taxonomic profile?" help="The file must have been created by MetaPhlan"/>
            <when value="yes">
                <param name="file" type="data" format="" label="Taxonomic profile file" help=""/>
            </when>
        </conditional>

        <param name="e_value" type="float" min="0" max="10" value="1" label="E-value threshold to use with the translated search" help=""/>
        <param name="identity" type="float" min="0" max="100" value="40" label="Identity threshold for alignments" help=""/>

    </inputs>

    <outputs>
        <outputs>
            <data format="html" name="html_file" label="humann2_outputs.html">
        </outputs>

    </outputs>

    <tests>

    </tests>

    <help>
        **What it does**

        HUMAnN is a pipeline tfor efficiently and accuretly profiling the presence/absence and abundance of microbial pathways in a community from metagenomic or metatranscriptomic sequencing data. 

        .. _Read more about the tool: http://huttenhower.sph.harvard.edu/humann2/manual

        **Input**

        Usually, a single file is the input. It must be one of the following types:

            - filtered shotgun sequencing metagenome file (fastq, fastq.gz, fasta, or fasta.gz format)
            - alignment file (sam, bam or blastm8 format)
            - gene table file (tsv or biom format)

        A file with taxonomic profiles can also be given to be use to select pangenomes in ChocoPhlan database.

        **Outputs**

        HUMAnN creates three output files:

            - Gene family abundance
            - Pathway abundance
            - Pathway coverage

        and intermediate temp files.

        Theses files are accessible via an html file

        **Parameters**


    </help>

    <citations>
    </citations>
</tool>